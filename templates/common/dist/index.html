<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Platform</title>
  {% load static %}
  <link rel="stylesheet" href="../../../static/common/dist/style.css">

</head>
<body>
<!-- partial:index.partial.html -->
<div class="container">
  <div class="bullets">
    <span class="active"></span>
    <span></span>
    <span></span>
  </div>
  <div class="form">
    <!-- 로그인 폼 타이틀 문구 -->
    <div class="title">
      Platform
    </div>    
    <!-- 이메일을 입력받는 부분 -->
    <div class="row visible">
      <input type="text" placeholder="이메일을 입력해주세요." />
      <div class="fa fa-user"></div>
      <div class="nextBtn"><i class="fa fa-chevron-right"></i></div>
    </div>
    <!-- 비밀번호를 입력받는 부분 -->
    <div class="row lastField">
      <input type="password" placeholder="비밀번호를 입력해주세요." />
      <div class="fa fa-key"></div>
      <div class="nextBtn"><i class="fa fa-chevron-right"></i></div>
    </div>

    <div class="login_text">간편 로그인</div>

    <!-- 로그인 API 토근 -->
    <div class="loginAPI_token">
      <!-- 네이버 -->
      <span class="login-area">
        <span id="message">
          <span id="button_area">
            <span id="naverIdLogin"></span>
          </span>
        </span>
      </span>
      <script src="https://static.nid.naver.com/js/naveridlogin_js_sdk_2.0.2.js" charset="utf-8"></script>
      <script type="text/javascript">
      
      const naverLogin = new naver.LoginWithNaverId(
      {
        clientId: "x2OwQmHAMDAXlB3QvDnL",
        callbackUrl: "http://127.0.0.1:8000/main/",
        loginButton: {color: "green", type: 1, height: 40}
        }
      );
      
  
        naverLogin.init();
        naverLogin.getLoginStatus(function (status) {
          if (status) {
              const nickName=naverLogin.user.getNickName();
              const age=naverLogin.user.getAge();
              const birthday=naverLogin.user.getBirthday();
  
              if(nickName===null||nickName===undefined ){
                alert("별명이 필요합니다. 정보제공을 동의해주세요.");
                naverLogin.reprompt();
                return ;  
            }else{
              setLoginStatus();
            }
      }
        });
        console.log(naverLogin);
  
        function setLoginStatus(){
        
          const message_area=document.getElementById('message');
          message_area.innerHTML=`
          <h3> Login 성공 </h3>
          // <div>user Nickname : ${naverLogin.user.nickname}</div>
          // <div>user Age(범위) : ${naverLogin.user.age}</div>
          // <div>user Birthday : ${naverLogin.user.birthday}</div>
          `;
        
          const button_area=document.getElementById('button_area');
          button_area.innerHTML="<button id='btn_logout'>로그아웃</button>";
  
          const logout=document.getElementById('btn_logout');
          logout.addEventListener('click',(e)=>{
            naverLogin.logout();
      location.replace("http://127.0.0.1:8000/main/");
          })
        }
      </script>
  
      <!-- 카카오톡 -->
      <span>
        <a href="javascript:kakaoLogin();">
          <img src="../../../static/common/kakao_login.png" alt="카카오계정 로그인" style="height: 40px;"/>
        </a>
      </span>
      <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
      <script>
        window.Kakao.init('410bd47035bb782d6bd87e48f7ea5407');
  
        function kakaoLogin() {
          window.Kakao.Auth.login({
              scope: 'profile_nickname, account_email, age_range', // 개인정보 동의항목
              success: function(response) {
                  console.log(response) // 로그인 성공하면 받아오는 데이터
                  window.Kakao.API.request({ // 사용자 정보 가져오기 
                      url: '/v2/user/me',
                      success: (res) => {
                          const kakao_account = res.kakao_account;
                          console.log(kakao_account)
                      }
                  });
                  // window.location.href='/ex/kakao_login.html' //리다이렉트 되는 코드
              },
              fail: function(error) {
                  console.log(error);
              }
          });
        }
      </script>
    </div>

  </div>
</div>
<!-- success 후에 스핀 도는 부분 -->
<div class="spinnerWrapper" style="display:none;">
  <svg class="spinner" width="65px" height="65px" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg">
     <circle class="path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle>
  </svg>
</div>
<!-- partial(부분적인) -->
  {% load static %}
  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js'></script><script  src="../../../static/common/dist/script.js"></script>

</body>
</html>
